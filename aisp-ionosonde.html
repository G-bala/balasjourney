<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AISP — Advanced Ionospheric Sounder Programmable</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@400;500;700;900&family=Space+Grotesk:wght@700;900&display=swap" rel="stylesheet"/>
<style>
  *{cursor:none!important;box-sizing:border-box;}
  body{margin:0;padding:0;font-family:'DM Sans','Segoe UI',sans-serif;background:#020712;color:#fff;overflow-x:hidden;}
  .glass{background:rgba(3,9,24,0.72);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,0.07);}
  .mono{font-family:'Space Mono',monospace;}
  .grad-text{background:linear-gradient(135deg,#22d3ee,#818cf8,#34d399);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
  #cursor{position:fixed;pointer-events:none;z-index:99999;transform:translate(-50%,-50%);transition:none;}
  #thunder{position:fixed;pointer-events:none;z-index:99998;transform:translateX(-50%);opacity:0;transition:opacity 0.15s ease;}
  @keyframes bounce{0%,100%{transform:translateX(-50%) translateY(0)}50%{transform:translateX(-50%) translateY(-8px)}}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.4}}
  .pulse{animation:pulse 2s infinite;}
  .bounce{animation:bounce 1.5s infinite;}
  section{position:relative;}
  .hover-scale{transition:transform 0.3s ease;}
  .hover-scale:hover{transform:scale(1.02);}
  a,button{transition:transform 0.3s ease,box-shadow 0.3s ease;}
  a:hover,button:hover{transform:scale(1.05);}
</style>
</head>
<body>

<!-- Sky Canvas -->
<canvas id="skyCanvas" style="position:fixed;inset:0;width:100%;height:100%;pointer-events:none;z-index:0;"></canvas>

<!-- Custom Cursor -->
<div id="cursor">
  <svg id="cursorSvg" width="26" height="18" viewBox="0 0 32 22" fill="none" xmlns="http://www.w3.org/2000/svg" style="filter:drop-shadow(0 1px 4px rgba(0,0,0,0.5));transition:width 0.15s,height 0.15s,filter 0.15s;">
    <path id="cloudBody" d="M8 18 C4 18 1 15 1 12 C1 9.5 2.8 7.4 5.2 6.8 C5.1 6.4 5 6 5 5.5 C5 3 7 1 9.5 1 C11 1 12.3 1.7 13.1 2.8 C13.9 2.3 14.9 2 16 2 C19.3 2 22 4.7 22 8 C22 8.3 22 8.6 21.9 8.9 C23.7 9.5 25 11.1 25 13 C25 15.2 23.2 17 21 17 L8 18 Z" fill="#ffffff" stroke="rgba(200,220,255,0.6)" stroke-width="0.8"/>
    <circle id="puff1" cx="10" cy="6" r="3.5" fill="#ffffff" stroke="rgba(200,220,255,0.4)" stroke-width="0.6"/>
    <circle id="puff2" cx="16" cy="4.5" r="4" fill="#ffffff" stroke="rgba(200,220,255,0.4)" stroke-width="0.6"/>
    <circle id="puff3" cx="21" cy="7" r="3" fill="#ffffff" stroke="rgba(200,220,255,0.4)" stroke-width="0.6"/>
  </svg>
</div>
<div id="thunder">
  <svg width="14" height="22" viewBox="0 0 14 22" fill="none">
    <defs>
      <linearGradient id="bolt" x1="7" y1="0" x2="7" y2="22" gradientUnits="userSpaceOnUse">
        <stop offset="0%" stop-color="#ffffff"/>
        <stop offset="60%" stop-color="#ffe066"/>
        <stop offset="100%" stop-color="#ffaa00" stop-opacity="0"/>
      </linearGradient>
      <filter id="glow"><feGaussianBlur stdDeviation="1.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    </defs>
    <polygon points="9,1 3,12 7,12 5,21 11,10 7,10 9,1" fill="url(#bolt)" filter="url(#glow)"/>
  </svg>
</div>

<!-- Content -->
<div style="position:relative;z-index:10;">

  <!-- NAV -->
  <nav id="navbar" style="position:fixed;top:0;left:0;right:0;z-index:50;transition:background 0.5s,backdrop-filter 0.5s,border-bottom 0.5s;">
    <div style="max-width:72rem;margin:0 auto;padding:1rem 1.5rem;display:flex;align-items:center;justify-content:space-between;">
      <div style="display:flex;align-items:center;gap:0.5rem;">
        <div style="width:2rem;height:2rem;border-radius:0.5rem;background:rgba(20,184,166,0.2);display:flex;align-items:center;justify-content:center;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#2dd4bf" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"/></svg>
        </div>
        <span class="mono" style="font-weight:700;color:#5eead4;letter-spacing:0.2em;font-size:0.875rem;">AISP</span>
      </div>
      <div style="display:flex;gap:2rem;">
        <button onclick="scrollTo('mission')" class="mono" style="background:none;border:none;color:#e2e8f0;font-size:0.875rem;letter-spacing:0.05em;padding:0;">MISSION</button>
        <button onclick="scrollTo('architecture')" class="mono" style="background:none;border:none;color:#e2e8f0;font-size:0.875rem;letter-spacing:0.05em;padding:0;">ARCHITECTURE</button>
        <button onclick="scrollTo('technology')" class="mono" style="background:none;border:none;color:#e2e8f0;font-size:0.875rem;letter-spacing:0.05em;padding:0;">TECHNOLOGY</button>
        <button onclick="scrollTo('results')" class="mono" style="background:none;border:none;color:#e2e8f0;font-size:0.875rem;letter-spacing:0.05em;padding:0;">RESULTS</button>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <section style="min-height:100vh;display:flex;flex-direction:column;justify-content:center;padding:6rem 1.5rem 2rem;">
    <div style="max-width:72rem;margin:0 auto;width:100%;">
      <div style="max-width:60%;">
        <div style="display:inline-flex;align-items:center;gap:0.5rem;border-radius:9999px;padding:0.375rem 1rem;margin-bottom:2rem;background:rgba(20,184,166,0.13);border:1px solid rgba(20,184,166,0.38);">
          <span class="pulse" style="width:0.5rem;height:0.5rem;border-radius:50%;background:#2dd4bf;display:inline-block;"></span>
          <span class="mono" style="font-size:0.7rem;letter-spacing:0.15em;color:#5eead4;">SDR-BASED IONOSPHERIC SOUNDER · DEVELOPED AT INGV, ITALY</span>
        </div>
        <h1 style="font-family:'Space Grotesk','DM Sans',sans-serif;font-size:clamp(3rem,8vw,5rem);font-weight:900;line-height:1;letter-spacing:-0.03em;margin:0 0 1.5rem;text-shadow:0 2px 20px rgba(0,0,0,0.7);">
          <span style="color:#fff;">AISP</span><br/>
          <span class="grad-text">Next-Gen</span><br/>
          <span style="color:#fff;">Ionosonde</span>
        </h1>
        <p style="color:#f1f5f9;font-size:1.125rem;line-height:1.75;margin-bottom:2.5rem;max-width:36rem;text-shadow:0 1px 10px rgba(0,0,0,0.7);">
          An SDR-based, fully programmable pulse compression ionosonde for real-time vertical ionospheric surveys. Developed and validated at <strong style="color:#5eead4;">INGV</strong> — the National Institute of Geophysics and Volcanology, Italy.
        </p>
        <div style="display:flex;flex-wrap:wrap;gap:1rem;">
          <button onclick="scrollTo('mission')" style="padding:0.75rem 2rem;border-radius:0.75rem;font-weight:700;font-size:0.875rem;letter-spacing:0.05em;background:linear-gradient(135deg,#0d9488,#0284c7);box-shadow:0 0 32px rgba(20,184,166,0.4);color:#fff;border:none;" class="mono">EXPLORE PROJECT</button>
          <button onclick="scrollTo('architecture')" class="glass mono" style="padding:0.75rem 2rem;border-radius:0.75rem;font-weight:700;font-size:0.875rem;letter-spacing:0.05em;color:#cbd5e1;border:none;">ARCHITECTURE</button>
        </div>
      </div>
    </div>
    <div class="bounce" style="position:absolute;bottom:2rem;left:50%;transform:translateX(-50%);">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#cbd5e1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
  </section>

  <!-- MISSION -->
  <section id="mission" style="padding:7rem 1.5rem;background:rgba(2,7,18,0.54);backdrop-filter:blur(4px);">
    <div style="max-width:72rem;margin:0 auto;">
      <div style="margin-bottom:4rem;">
        <span class="mono" style="color:#2dd4bf;font-size:0.7rem;letter-spacing:0.2em;font-weight:700;">01 / THE MISSION</span>
        <h2 style="font-size:clamp(2rem,5vw,3rem);font-weight:900;margin:0.75rem 0 1.5rem;letter-spacing:-0.02em;">Redefining Ionospheric<br/><span style="color:#22d3ee;">Sounding</span></h2>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:4rem;">
        <div class="glass" style="border-radius:1rem;padding:2rem;border-color:rgba(239,68,68,0.25)!important;border:1px solid rgba(239,68,68,0.25);">
          <div style="width:2.5rem;height:2.5rem;border-radius:0.75rem;background:rgba(239,68,68,0.15);display:flex;align-items:center;justify-content:center;margin-bottom:1.25rem;">
            <span style="color:#f87171;font-weight:700;font-size:1.125rem;">✕</span>
          </div>
          <h3 style="font-size:1.25rem;font-weight:700;color:#fff;margin:0 0 0.75rem;">The Challenge</h3>
          <p style="color:#94a3b8;line-height:1.7;margin:0;">Traditional ionosondes rely on fixed, hardware-heavy architectures. Inflexible analog chains, proprietary waveform generators, and rigid operating modes make them difficult to adapt for evolving research needs.</p>
        </div>
        <div class="glass" style="border-radius:1rem;padding:2rem;border:1px solid rgba(20,184,166,0.25);">
          <div style="width:2.5rem;height:2.5rem;border-radius:0.75rem;background:rgba(20,184,166,0.15);display:flex;align-items:center;justify-content:center;margin-bottom:1.25rem;">
            <span style="color:#2dd4bf;font-weight:700;font-size:1.125rem;">✓</span>
          </div>
          <h3 style="font-size:1.25rem;font-weight:700;color:#fff;margin:0 0 0.75rem;">The Solution — AISP</h3>
          <p style="color:#94a3b8;line-height:1.7;margin:0;">AISP was developed and validated at <strong style="color:#2dd4bf;">INGV — National Institute of Geophysics and Volcanology, Italy</strong>. It evolves the existing INGV AIS ionosonde by replacing bespoke hardware with SDR platforms that act as both transmitter and receiver, creating a fully software-reconfigurable ionosonde with unprecedented versatility.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ARCHITECTURE -->
  <section id="architecture" style="padding:7rem 1.5rem;background:rgba(2,7,18,0.48);backdrop-filter:blur(3px);">
    <div style="max-width:72rem;margin:0 auto;">
      <div style="margin-bottom:4rem;">
        <span class="mono" style="color:#2dd4bf;font-size:0.7rem;letter-spacing:0.2em;font-weight:700;">02 / ARCHITECTURE</span>
        <h2 style="font-size:clamp(2rem,5vw,3rem);font-weight:900;margin:0.75rem 0;letter-spacing:-0.02em;">System <span style="color:#22d3ee;">Design</span></h2>
      </div>

      <!-- Signal Flow -->
      <div class="glass" style="border-radius:1rem;padding:2rem;margin-bottom:2rem;">
        <div class="mono" style="font-size:0.7rem;color:#64748b;letter-spacing:0.2em;margin-bottom:1.5rem;">SIGNAL PROCESSING CHAIN</div>
        <div id="flowDiagram" style="display:flex;align-items:flex-start;justify-content:center;flex-wrap:wrap;gap:0.5rem;"></div>
      </div>

      <!-- Bento Grid -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.5rem;position:relative;overflow:hidden;">
          <div style="position:absolute;top:0;right:0;width:8rem;height:8rem;border-radius:50%;background:#22d3ee;opacity:0.1;filter:blur(2rem);transform:translate(25%,-25%);"></div>
          <div style="width:3rem;height:3rem;border-radius:0.75rem;background:rgba(34,211,238,0.2);display:flex;align-items:center;justify-content:center;margin-bottom:0.75rem;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#22d3ee" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"/></svg>
          </div>
          <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">SDR Core</h3>
          <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Acts as both transmitter and receiver, handling RF signal generation, timing control, and coherent I/Q data acquisition across 1–30 MHz.</p>
        </div>
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.5rem;position:relative;overflow:hidden;">
          <div style="position:absolute;top:0;right:0;width:8rem;height:8rem;border-radius:50%;background:#34d399;opacity:0.1;filter:blur(2rem);transform:translate(25%,-25%);"></div>
          <div style="width:3rem;height:3rem;border-radius:0.75rem;background:rgba(52,211,153,0.2);display:flex;align-items:center;justify-content:center;margin-bottom:0.75rem;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
          </div>
          <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">Pulse Compression Engine</h3>
          <p style="color:#52b788;font-size:0.75rem;font-weight:600;margin:0 0 0.25rem;" class="mono">Complementary coded pulse</p>
          <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Coded pulse radar techniques dramatically improve SNR, enabling detection of weak ionospheric echoes that traditional ionosondes miss.</p>
        </div>
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.5rem;position:relative;overflow:hidden;grid-column:span 2;">
          <div style="position:absolute;top:0;right:0;width:8rem;height:8rem;border-radius:50%;background:#38bdf8;opacity:0.1;filter:blur(2rem);transform:translate(25%,-25%);"></div>
          <div style="width:3rem;height:3rem;border-radius:0.75rem;background:rgba(56,189,248,0.2);display:flex;align-items:center;justify-content:center;margin-bottom:0.75rem;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#38bdf8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" y1="20" x2="12.01" y2="20"/></svg>
          </div>
          <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">Ethernet Interface</h3>
          <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">High-speed PC-to-SDR Ethernet link allows flexible configuration, remote deployment, and near-real-time data streaming to analysis nodes.</p>
        </div>
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.5rem;position:relative;overflow:hidden;grid-column:span 2;">
          <div style="position:absolute;top:0;right:0;width:8rem;height:8rem;border-radius:50%;background:#f472b6;opacity:0.1;filter:blur(2rem);transform:translate(25%,-25%);"></div>
          <div style="width:3rem;height:3rem;border-radius:0.75rem;background:rgba(244,114,182,0.2);display:flex;align-items:center;justify-content:center;margin-bottom:0.75rem;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f472b6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
          </div>
          <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">Power &amp; Antenna Control</h3>
          <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Integrated management of RF power amplifiers and specialized antenna arrays ensures coordinated transmission with optimal radiated power.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- TECHNOLOGY -->
  <section id="technology" style="padding:7rem 1.5rem;background:rgba(2,7,18,0.54);backdrop-filter:blur(4px);">
    <div style="max-width:72rem;margin:0 auto;">
      <div style="margin-bottom:4rem;">
        <span class="mono" style="color:#2dd4bf;font-size:0.7rem;letter-spacing:0.2em;font-weight:700;">03 / TECHNOLOGY</span>
        <h2 style="font-size:clamp(2rem,5vw,3rem);font-weight:900;margin:0.75rem 0 0.5rem;letter-spacing:-0.02em;">Key Technical <span style="color:#22d3ee;">Features</span></h2>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:4rem;">
        <!-- Card 1 -->
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.25rem;border:1px solid rgba(34,211,238,0.22);position:relative;overflow:hidden;">
          <div style="position:absolute;inset:0;background:radial-gradient(circle at top right,#22d3ee,transparent 65%);opacity:0.05;"></div>
          <div style="display:flex;align-items:flex-start;gap:1rem;">
            <div style="border-radius:0.75rem;padding:0.625rem;background:rgba(34,211,238,0.2);flex-shrink:0;">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#22d3ee" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            </div>
            <div>
              <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">Coded Pulse Radar</h3>
              <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Complementary Golay 16 waveform for high-resolution range measurement via complex correlation.</p>
            </div>
          </div>
        </div>
        <!-- Card 2 -->
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.25rem;border:1px solid rgba(52,211,153,0.22);position:relative;overflow:hidden;">
          <div style="position:absolute;inset:0;background:radial-gradient(circle at top right,#34d399,transparent 65%);opacity:0.05;"></div>
          <div style="display:flex;align-items:flex-start;gap:1rem;">
            <div style="border-radius:0.75rem;padding:0.625rem;background:rgba(52,211,153,0.2);flex-shrink:0;">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="2" x2="9" y2="4"/><line x1="15" y1="2" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="22"/><line x1="15" y1="20" x2="15" y2="22"/><line x1="20" y1="9" x2="22" y2="9"/><line x1="20" y1="14" x2="22" y2="14"/><line x1="2" y1="9" x2="4" y2="9"/><line x1="2" y1="14" x2="4" y2="14"/></svg>
            </div>
            <div>
              <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">SDR-Based DSP</h3>
              <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Real-time signal processing, filtering, and decimation in programmable fabric.</p>
            </div>
          </div>
        </div>
        <!-- Card 3 -->
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.25rem;border:1px solid rgba(167,139,250,0.22);position:relative;overflow:hidden;">
          <div style="position:absolute;inset:0;background:radial-gradient(circle at top right,#a78bfa,transparent 65%);opacity:0.05;"></div>
          <div style="display:flex;align-items:flex-start;gap:1rem;">
            <div style="border-radius:0.75rem;padding:0.625rem;background:rgba(167,139,250,0.2);flex-shrink:0;">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
            </div>
            <div>
              <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">2D-CA-CFAR Algorithm</h3>
              <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Constant False Alarm Rate detection of ionospheric echoes against noise.</p>
            </div>
          </div>
        </div>
        <!-- Card 4 -->
        <div class="glass hover-scale" style="border-radius:1rem;padding:1.25rem;border:1px solid rgba(251,146,60,0.22);position:relative;overflow:hidden;">
          <div style="position:absolute;inset:0;background:radial-gradient(circle at top right,#fb923c,transparent 65%);opacity:0.05;"></div>
          <div style="display:flex;align-items:flex-start;gap:1rem;">
            <div style="border-radius:0.75rem;padding:0.625rem;background:rgba(251,146,60,0.2);flex-shrink:0;">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fb923c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
            </div>
            <div>
              <h3 class="mono" style="color:#fff;font-weight:700;font-size:0.875rem;margin:0 0 0.25rem;">Programmable Waveforms</h3>
              <p style="color:#94a3b8;font-size:0.875rem;line-height:1.6;margin:0;">Software-switchable pulse patterns.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tech Stack -->
      <div class="glass" style="border-radius:1rem;padding:2rem;">
        <div class="mono" style="font-size:0.7rem;color:#64748b;letter-spacing:0.2em;margin-bottom:2rem;">TECHNOLOGY STACK</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:2rem;">
          <div>
            <div class="mono" style="color:#2dd4bf;font-size:0.7rem;font-weight:700;letter-spacing:0.2em;margin-bottom:1rem;">HARDWARE</div>
            <div style="display:flex;flex-direction:column;gap:0.5rem;">
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>SDR Platforms (USRP N-series)</div>
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>Custom RF Power Amplifiers</div>
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>Broadband Antenna Arrays</div>
            </div>
          </div>
          <div>
            <div class="mono" style="color:#2dd4bf;font-size:0.7rem;font-weight:700;letter-spacing:0.2em;margin-bottom:1rem;">SOFTWARE</div>
            <div style="display:flex;flex-direction:column;gap:0.5rem;">
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>C++ Host Control Layer</div>
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>Python Analysis Pipeline</div>
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>GNU Radio / UHD Drivers</div>
            </div>
          </div>
          <div>
            <div class="mono" style="color:#2dd4bf;font-size:0.7rem;font-weight:700;letter-spacing:0.2em;margin-bottom:1rem;">METHODOLOGY</div>
            <div style="display:flex;flex-direction:column;gap:0.5rem;">
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>Vertical Ionospheric Sounding</div>
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>Pulse Compression</div>
              <div style="display:flex;align-items:center;gap:0.5rem;color:#94a3b8;font-size:0.875rem;"><div style="width:4px;height:4px;border-radius:50%;background:#2dd4bf;flex-shrink:0;"></div>2D Complex Correlation</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- RESULTS -->
  <section id="results" style="padding:7rem 1.5rem;background:rgba(2,7,18,0.50);backdrop-filter:blur(4px);">
    <div style="max-width:72rem;margin:0 auto;">
      <div style="margin-bottom:4rem;">
        <span class="mono" style="color:#2dd4bf;font-size:0.7rem;letter-spacing:0.2em;font-weight:700;">04 / RESULTS</span>
        <h2 style="font-size:clamp(2rem,5vw,3rem);font-weight:900;margin:0.75rem 0;letter-spacing:-0.02em;">Research <span style="color:#22d3ee;">Impact</span></h2>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1.5rem;margin-bottom:3rem;">
        <div class="glass" style="border-radius:1rem;padding:2rem;text-align:center;border:1px solid rgba(34,211,238,0.3);">
          <div class="mono" style="font-size:3rem;font-weight:900;color:#22d3ee;margin-bottom:0.5rem;">&lt; 1 km</div>
          <div style="color:#fff;font-weight:700;margin-bottom:0.25rem;">Virtual Height Resolution</div>
          <div style="color:#64748b;font-size:0.875rem;">Pulse compression derived</div>
        </div>
        <div class="glass" style="border-radius:1rem;padding:2rem;text-align:center;border:1px solid rgba(52,211,153,0.3);">
          <div class="mono" style="font-size:3rem;font-weight:900;color:#34d399;margin-bottom:0.5rem;">1–30</div>
          <div style="color:#fff;font-weight:700;margin-bottom:0.25rem;">MHz Sweep Range</div>
          <div style="color:#64748b;font-size:0.875rem;">Full HF band coverage</div>
        </div>
        <div class="glass" style="border-radius:1rem;padding:2rem;text-align:center;border:1px solid rgba(167,139,250,0.3);">
          <div class="mono" style="font-size:3rem;font-weight:900;color:#a78bfa;margin-bottom:0.5rem;">2D-CA-CFAR</div>
          <div style="color:#fff;font-weight:700;margin-bottom:0.25rem;">Echo Detection</div>
          <div style="color:#64748b;font-size:0.875rem;">Adaptive noise estimation</div>
        </div>
      </div>
      <div class="glass" style="border-radius:1rem;padding:2rem;border:1px solid rgba(20,184,166,0.22);">
        <div style="display:flex;align-items:flex-start;gap:1rem;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#2dd4bf" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink:0;margin-top:0.25rem;"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
          <div>
            <h3 style="font-size:1.25rem;font-weight:700;color:#fff;margin:0 0 0.75rem;">Validated at INGV · Global Ionospheric Models</h3>
            <p style="color:#94a3b8;line-height:1.7;margin:0;">AISP has been operationally validated at <strong style="color:#2dd4bf;">INGV — the National Institute of Geophysics and Volcanology, Italy</strong>, one of Europe's foremost Earth science research bodies.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer style="padding:3.5rem 1.5rem;text-align:center;background:rgba(2,7,18,0.85);border-top:1px solid rgba(20,184,166,0.1);">
    <div style="display:flex;align-items:center;justify-content:center;gap:0.5rem;margin-bottom:0.75rem;">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#14b8a6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"/></svg>
      <span class="mono" style="color:#14b8a6;font-weight:700;letter-spacing:0.2em;font-size:0.875rem;">AISP</span>
    </div>
    <p style="color:#475569;font-size:0.75rem;letter-spacing:0.05em;margin:0 0 2rem;">Advanced Ionospheric Sounder Programmable · Developed &amp; Validated at INGV, Italy</p>
    <div style="max-width:32rem;margin:0 auto;border-radius:1rem;padding:1.5rem;background:rgba(20,184,166,0.06);border:1px solid rgba(20,184,166,0.2);">
      <p style="color:#94a3b8;font-size:0.875rem;margin:0 0 0.25rem;">Want to learn more about AISP?</p>
      <p style="color:#64748b;font-size:0.75rem;margin:0 0 1rem;">Read the full peer-reviewed research paper published in <span style="color:#e2e8f0;font-weight:600;">Advances in Space Research</span></p>
      <a href="https://doi.org/10.1016/j.asr.2025.04.072" target="_blank" rel="noopener noreferrer"
        class="mono"
        style="display:inline-flex;align-items:center;gap:0.5rem;padding:0.75rem 1.5rem;border-radius:0.75rem;font-size:0.875rem;font-weight:700;letter-spacing:0.05em;background:linear-gradient(135deg,#0d9488,#0284c7);box-shadow:0 0 24px rgba(20,184,166,0.3);color:#fff;text-decoration:none;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
        SEE THE PAPER
      </a>
      <p class="mono" style="color:#334155;font-size:0.75rem;margin:1rem 0 0;">doi.org/10.1016/j.asr.2025.04.072</p>
    </div>
  </footer>

</div>

<script>
// ── CURSOR ──────────────────────────────────────────────────────────────────
const cursor = document.getElementById('cursor');
const thunder = document.getElementById('thunder');
const cursorSvg = document.getElementById('cursorSvg');
const cloudBody = document.getElementById('cloudBody');
const puffs = [document.getElementById('puff1'), document.getElementById('puff2'), document.getElementById('puff3')];

let cx = -100, cy = -100;

document.addEventListener('mousemove', e => {
  cx = e.clientX; cy = e.clientY;
  cursor.style.left = cx + 'px';
  cursor.style.top  = cy + 'px';
  thunder.style.left = cx + 'px';
  thunder.style.top  = (cy + 22) + 'px';

  const el = document.elementFromPoint(cx, cy);
  const isClick = el && (
    window.getComputedStyle(el).cursor === 'pointer' ||
    el.tagName === 'BUTTON' || el.tagName === 'A' ||
    el.closest('button') || el.closest('a')
  );

  const fill = isClick ? '#111' : '#fff';
  const stroke = isClick ? '#000' : 'rgba(200,220,255,0.6)';
  cloudBody.setAttribute('fill', fill);
  cloudBody.setAttribute('stroke', stroke);
  puffs.forEach(p => { p.setAttribute('fill', fill); p.setAttribute('stroke', isClick ? '#000' : 'rgba(200,220,255,0.4)'); });
  cursorSvg.style.filter = isClick ? 'drop-shadow(0 0 6px rgba(0,0,0,0.9))' : 'drop-shadow(0 1px 4px rgba(0,0,0,0.5))';
  cursorSvg.setAttribute('width',  isClick ? 32 : 26);
  cursorSvg.setAttribute('height', isClick ? 22 : 18);
  thunder.style.opacity = isClick ? '1' : '0';
});

// ── NAVBAR SCROLL ───────────────────────────────────────────────────────────
const navbar = document.getElementById('navbar');
window.addEventListener('scroll', () => {
  if (window.scrollY > 60) {
    navbar.style.background = 'rgba(3,9,24,0.88)';
    navbar.style.backdropFilter = 'blur(20px)';
    navbar.style.borderBottom = '1px solid rgba(20,184,166,0.12)';
  } else {
    navbar.style.background = 'transparent';
    navbar.style.backdropFilter = 'none';
    navbar.style.borderBottom = 'none';
  }
}, { passive: true });

// ── SMOOTH SCROLL ───────────────────────────────────────────────────────────
function scrollTo(id) {
  document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
}

// ── FLOW DIAGRAM ─────────────────────────────────────────────────────────────
const steps = [
  { label: 'Pulse Coding',    sub: 'Waveform Gen',  color: '#38bdf8', icon: `<path d="M16 18l2-2-2-2M8 6L6 8l2 2" stroke-linecap="round" stroke-linejoin="round"/><path d="M10.5 20.5l3-17" stroke-linecap="round"/>` },
  { label: 'SDR Transmitter', sub: 'RF Output',     color: '#22d3ee', icon: `<circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"/>` },
  { label: 'Ionosphere',      sub: '150 – 700 km',  color: '#a78bfa', icon: `<polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/>` },
  { label: 'Reflection',      sub: 'Echo Return',   color: '#f472b6', icon: `<line x1="22" y1="16.92" x2="22" y2="16.92"/><line x1="16.92" y1="22" x2="16.92" y2="22"/><line x1="1" y1="1" x2="23" y2="23"/><path d="M11.05 1A10 10 0 0 1 23 12.95M16.54 16.54A5 5 0 0 1 7.46 7.46"/>` },
  { label: 'SDR Receiver',    sub: 'Correlation',   color: '#34d399', icon: `<rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="2" x2="9" y2="4"/><line x1="15" y1="2" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="22"/><line x1="15" y1="20" x2="15" y2="22"/><line x1="20" y1="9" x2="22" y2="9"/><line x1="20" y1="14" x2="22" y2="14"/><line x1="2" y1="9" x2="4" y2="9"/><line x1="2" y1="14" x2="4" y2="14"/>` },
  { label: 'PC Analysis',     sub: 'Ionogram',      color: '#fb923c', icon: `<line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/>` },
];

const flow = document.getElementById('flowDiagram');
steps.forEach((s, i) => {
  // Step
  const step = document.createElement('div');
  step.style.cssText = 'display:flex;flex-direction:column;align-items:center;gap:6px;';
  step.innerHTML = `
    <div style="width:76px;height:76px;border-radius:1rem;display:flex;align-items:center;justify-content:center;background:${s.color}18;border:1px solid ${s.color}40;box-shadow:0 0 18px ${s.color}18;transition:transform 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
      <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="${s.color}" stroke-width="2">${s.icon}</svg>
    </div>
    <span style="font-family:'Space Mono',monospace;font-size:0.65rem;font-weight:700;color:${s.color};text-align:center;max-width:80px;line-height:1.3;">${s.label}</span>
    <span style="font-size:0.65rem;color:#94a3b8;text-align:center;">${s.sub}</span>
  `;
  flow.appendChild(step);

  // Arrow
  if (i < steps.length - 1) {
    const arrow = document.createElement('div');
    arrow.style.cssText = 'flex-shrink:0;margin:0 6px;padding-top:28px;';
    arrow.innerHTML = `
      <svg width="36" height="20" viewBox="0 0 36 20" fill="none">
        <defs>
          <linearGradient id="ag${i}" x1="0" y1="0" x2="36" y2="0" gradientUnits="userSpaceOnUse">
            <stop offset="0%" stop-color="${s.color}" stop-opacity="0.6"/>
            <stop offset="100%" stop-color="${steps[i+1].color}" stop-opacity="0.9"/>
          </linearGradient>
        </defs>
        <line x1="0" y1="10" x2="26" y2="10" stroke="url(#ag${i})" stroke-width="2" stroke-linecap="round"/>
        <polyline points="22,4 32,10 22,16" fill="none" stroke="${steps[i+1].color}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    `;
    flow.appendChild(arrow);
  }
});

// ── SKY CANVAS ───────────────────────────────────────────────────────────────
const canvas = document.getElementById('skyCanvas');
const ctx = canvas.getContext('2d');
let t = 0;
const kp = 2, flareI_val = 1;
const stormI = Math.min(kp / 9, 1);
const flareI = Math.min(flareI_val / 10, 1);

const particles = Array.from({ length: 220 }, () => ({
  x: window.innerWidth * (0.76 + Math.random() * 0.22),
  y: window.innerHeight * (Math.random() * 0.28),
  vx: -(Math.random() * 1.6 + 0.4),
  vy: (Math.random() - 0.5) * 0.45,
  life: Math.random(),
  maxLife: Math.random() * 0.7 + 0.3,
  size: Math.random() * 2.5 + 0.5,
  hue: Math.random() * 40 + 15,
}));

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

function drawSky() {
  const W = canvas.width, H = canvas.height;
  t += 0.007;
  const cmePhase = (Math.sin(t * (0.3 + stormI * 0.4)) + 1) * 0.5;

  ctx.clearRect(0, 0, W, H);

  // Sky gradient
  const skyGrad = ctx.createLinearGradient(0, 0, 0, H);
  const stormR = Math.round(stormI * 40);
  skyGrad.addColorStop(0.00, `rgb(${1+stormR},${3+stormR/4},15)`);
  skyGrad.addColorStop(0.07, `rgb(${7+stormR},12,30)`);
  skyGrad.addColorStop(0.16, '#0b2050');
  skyGrad.addColorStop(0.28, '#0d4a9e');
  skyGrad.addColorStop(0.42, '#1668c4');
  skyGrad.addColorStop(0.57, '#2e8fd8');
  skyGrad.addColorStop(0.70, '#5ab5e8');
  skyGrad.addColorStop(0.83, '#98d4f2');
  skyGrad.addColorStop(0.93, '#c8e9f8');
  skyGrad.addColorStop(1.00, '#e8f5fb');
  ctx.fillStyle = skyGrad;
  ctx.fillRect(0, 0, W, H);

  // Ionospheric layers
  const ionoLayers = [
    { yFrac:0.05, color:[160,100,255], alpha:0.14+stormI*0.1,  thick:H*0.04  },
    { yFrac:0.13, color:[100,60,255],  alpha:0.20+stormI*0.12, thick:H*0.06  },
    { yFrac:0.23, color:[60,120,255],  alpha:0.17+stormI*0.08, thick:H*0.055 },
    { yFrac:0.33, color:[20,190,215],  alpha:0.16+stormI*0.07, thick:H*0.055 },
    { yFrac:0.44, color:[50,170,255],  alpha:0.10+stormI*0.05, thick:H*0.08  },
    { yFrac:0.57, color:[90,200,235],  alpha:0.08+stormI*0.04, thick:H*0.10  },
  ];
  const labelDefs = [
    { yFrac:0.05, label:'EXOSPHERE',               color:[160,100,255] },
    { yFrac:0.13, label:'THERMOSPHERE',  color:[100,60,255]  },
    { yFrac:0.23, label:'THERMOSPHERE',  color:[60,120,255]  },
    { yFrac:0.33, label:'MESOSPHERE',     color:[20,190,215]  },
    { yFrac:0.44, label:'STRATOSPHERE',       color:[50,170,255]  },
    { yFrac:0.57, label:'TROPOSPHERE',        color:[90,200,235]  },
  ];

  ionoLayers.forEach(({ yFrac, color:[r,g,b], alpha, thick }) => {
    const cy = yFrac * H;
    const waveAmp = 7 + stormI * 14;
    const bandGrad = ctx.createLinearGradient(0, cy-thick*0.6, 0, cy+thick*0.6);
    bandGrad.addColorStop(0,    `rgba(${r},${g},${b},0)`);
    bandGrad.addColorStop(0.35, `rgba(${r},${g},${b},${alpha})`);
    bandGrad.addColorStop(0.65, `rgba(${r},${g},${b},${alpha})`);
    bandGrad.addColorStop(1,    `rgba(${r},${g},${b},0)`);
    ctx.beginPath();
    ctx.moveTo(0, cy-thick*0.6);
    for (let x=0; x<=W; x+=6) {
      const wave = Math.sin(x*0.005+t*(0.6+stormI))*waveAmp + Math.sin(x*0.011-t*0.4)*4;
      ctx.lineTo(x, cy-thick*0.6+wave);
    }
    for (let x=W; x>=0; x-=6) {
      const wave = Math.sin(x*0.005+t*(0.6+stormI))*waveAmp + Math.sin(x*0.011-t*0.4)*4;
      ctx.lineTo(x, cy+thick*0.6+wave);
    }
    ctx.closePath();
    ctx.fillStyle = bandGrad;
    ctx.fill();
    ctx.save();
    ctx.beginPath();
    for (let x=0; x<=W; x+=4) {
      const wave = Math.sin(x*0.005+t*(0.6+stormI))*waveAmp + Math.sin(x*0.011-t*0.4)*4;
      if (x===0) ctx.moveTo(x, cy+wave); else ctx.lineTo(x, cy+wave);
    }
    ctx.strokeStyle = `rgba(${r},${g},${b},${alpha*2.2})`;
    ctx.lineWidth = 1;
    ctx.stroke();
    ctx.restore();
  });

  // Aurora
  const aurCount = 4 + Math.round(stormI * 4);
  for (let ai=0; ai<aurCount; ai++) {
    const auroraX = W * (0.04 + ai*(0.9/aurCount));
    const auroraW = W * (0.14 + stormI*0.08);
    for (let x=auroraX; x<auroraX+auroraW; x+=3) {
      const nx = (x-auroraX)/auroraW;
      const wave = Math.sin(nx*Math.PI*3 + t*(0.8+stormI*0.5) + ai*1.2) * (20+stormI*30);
      const hue = 155 + ai*35 + Math.sin(t*0.7+ai)*25 - stormI*20;
      const baseA = 0.08 + stormI*0.18;
      const aGrad = ctx.createLinearGradient(x, 0, x, H*(0.5+stormI*0.2));
      aGrad.addColorStop(0,    `hsla(${hue},85%,65%,0)`);
      aGrad.addColorStop(0.1,  `hsla(${hue},95%,70%,${baseA})`);
      aGrad.addColorStop(0.3,  `hsla(${hue},90%,65%,${baseA*1.6})`);
      aGrad.addColorStop(0.55, `hsla(${hue},80%,60%,${baseA*0.7})`);
      aGrad.addColorStop(1,    `hsla(${hue},70%,55%,0)`);
      ctx.fillStyle = aGrad;
      ctx.fillRect(x+wave, 0, 3, H*(0.65+stormI*0.2));
    }
  }

  // Sun
  const sunX = W*0.87, sunY = H*0.07, sunR = Math.min(W,H)*0.085;
  for (let gi=7; gi>=1; gi--) {
    const cr = sunR*(1+gi*(0.75+flareI*0.3));
    const a = (0.032+flareI*0.02)/gi;
    const cGrad = ctx.createRadialGradient(sunX,sunY,sunR*0.4,sunX,sunY,cr);
    cGrad.addColorStop(0,   `rgba(255,${215-flareI*30},60,${a*5})`);
    cGrad.addColorStop(0.4, `rgba(255,${160-flareI*20},20,${a*2})`);
    cGrad.addColorStop(1,   'rgba(255,80,0,0)');
    ctx.fillStyle = cGrad;
    ctx.beginPath(); ctx.arc(sunX,sunY,cr,0,Math.PI*2); ctx.fill();
  }
  const innerCorona = ctx.createRadialGradient(sunX,sunY,sunR*0.8,sunX,sunY,sunR*(2.2+flareI*0.5));
  innerCorona.addColorStop(0,   `rgba(255,${240-flareI*40},120,${0.55+flareI*0.2})`);
  innerCorona.addColorStop(0.4, `rgba(255,${180-flareI*30},40,${0.25+flareI*0.1})`);
  innerCorona.addColorStop(1,   'rgba(255,100,0,0)');
  ctx.fillStyle = innerCorona;
  ctx.beginPath(); ctx.arc(sunX,sunY,sunR*(2.2+flareI*0.5),0,Math.PI*2); ctx.fill();
  const disc = ctx.createRadialGradient(sunX-sunR*0.25,sunY-sunR*0.25,0,sunX,sunY,sunR);
  disc.addColorStop(0,   '#fffef0');
  disc.addColorStop(0.35,`rgb(255,${248-flareI*20},${200-flareI*30})`);
  disc.addColorStop(0.7, `rgb(255,${220-flareI*30},${40-flareI*5})`);
  disc.addColorStop(1,   `rgb(255,${150-flareI*30},0)`);
  ctx.fillStyle = disc;
  ctx.beginPath(); ctx.arc(sunX,sunY,sunR,0,Math.PI*2); ctx.fill();

  // Prominences
  const promCount = 5 + Math.round(stormI*4);
  for (let pi=0; pi<promCount; pi++) {
    const pBase = (pi/promCount)*Math.PI*2 + t*(0.12+stormI*0.08);
    const pR = sunR*(1.05 + Math.sin(t*0.9+pi*1.3)*(0.1+stormI*0.2));
    const arcSpread = 0.28 + Math.sin(t*0.6+pi)*0.08;
    const px1 = sunX+Math.cos(pBase-arcSpread)*pR;
    const py1 = sunY+Math.sin(pBase-arcSpread)*pR;
    const px2 = sunX+Math.cos(pBase+arcSpread)*pR;
    const py2 = sunY+Math.sin(pBase+arcSpread)*pR;
    const loopH = pR*(0.55+stormI*0.5+Math.sin(t*0.7+pi)*0.25);
    const cpx = sunX+Math.cos(pBase)*(pR+loopH);
    const cpy = sunY+Math.sin(pBase)*(pR+loopH);
    ctx.beginPath(); ctx.moveTo(px1,py1); ctx.quadraticCurveTo(cpx,cpy,px2,py2);
    ctx.strokeStyle = `rgba(255,${80+pi*20-stormI*30},${pi*8},${0.5+stormI*0.3})`;
    ctx.lineWidth = 2.5+stormI*1.5;
    ctx.shadowBlur = 12+stormI*8; ctx.shadowColor = `rgba(255,${100-stormI*50},0,0.6)`;
    ctx.stroke(); ctx.shadowBlur = 0;
  }

  // CME jets
  const cmeJetAngles = [Math.PI+0.45, Math.PI+0.65, Math.PI+0.85];
  cmeJetAngles.forEach((jetAngle, ji) => {
    const jetLen = sunR*(3.5+cmePhase*(4+stormI*6)-ji*0.4);
    const spread = 0.18-ji*0.04;
    const jGrad = ctx.createLinearGradient(sunX,sunY,sunX+Math.cos(jetAngle)*jetLen,sunY+Math.sin(jetAngle)*jetLen);
    jGrad.addColorStop(0,   `rgba(255,${200-stormI*60},60,${0.7-ji*0.15})`);
    jGrad.addColorStop(0.25,`rgba(255,${130-stormI*40},20,${0.45-ji*0.1})`);
    jGrad.addColorStop(0.6, `rgba(255,${60-stormI*20},0,${0.18-ji*0.05})`);
    jGrad.addColorStop(1,   'rgba(200,20,0,0)');
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(sunX,sunY);
    ctx.lineTo(sunX+Math.cos(jetAngle-spread)*jetLen, sunY+Math.sin(jetAngle-spread)*jetLen);
    ctx.arc(sunX,sunY,jetLen,jetAngle-spread,jetAngle+spread);
    ctx.lineTo(sunX,sunY);
    ctx.closePath();
    ctx.fillStyle = jGrad; ctx.fill();
    ctx.restore();
  });

  // Shockwave rings
  for (let ri=0; ri<2+Math.round(stormI*2); ri++) {
    const rPhase = ((cmePhase+ri*0.33)%1);
    const rR = sunR*(1.8+rPhase*(5+stormI*4));
    const rAlpha = (1-rPhase)*(0.22+stormI*0.15);
    const rGrad = ctx.createRadialGradient(sunX,sunY,rR*0.9,sunX,sunY,rR*1.1);
    rGrad.addColorStop(0,   'rgba(255,160,40,0)');
    rGrad.addColorStop(0.5, `rgba(255,${140-stormI*40},30,${rAlpha})`);
    rGrad.addColorStop(1,   'rgba(255,80,0,0)');
    ctx.fillStyle = rGrad;
    ctx.beginPath(); ctx.arc(sunX,sunY,rR*1.1,0,Math.PI*2); ctx.fill();
  }

  // Solar wind particles
  const speedMult = 1+stormI*3.5;
  particles.forEach(p => {
    p.x += p.vx*speedMult; p.y += p.vy; p.life += 0.007;
    if (p.life>p.maxLife || p.x<-10) {
      p.x = sunX+(Math.random()-0.5)*sunR*2.5;
      p.y = sunY+(Math.random()-0.5)*sunR*2.5;
      p.life=0; p.maxLife=Math.random()*0.7+0.3;
    }
    const lr = p.life/p.maxLife;
    const alpha = lr<0.2?lr/0.2:lr>0.75?(1-lr)/0.25:1;
    ctx.beginPath(); ctx.arc(p.x,p.y,p.size*(1-lr*0.4),0,Math.PI*2);
    ctx.fillStyle = `hsla(${p.hue+lr*25+stormI*30},90%,72%,${alpha*(0.6+stormI*0.3)})`;
    ctx.fill();
  });

  // Storm tint
  const stormTint = ctx.createRadialGradient(sunX,H*0.12,sunR,W*0.3,H*0.2,W);
  stormTint.addColorStop(0,   `rgba(255,${140-stormI*80},20,${0.04+stormI*0.12})`);
  stormTint.addColorStop(0.35,`rgba(255,${80-stormI*50},10,${0.02+stormI*0.07})`);
  stormTint.addColorStop(0.7, 'rgba(180,20,0,0.01)');
  stormTint.addColorStop(1,   'rgba(0,0,0,0)');
  ctx.fillStyle = stormTint; ctx.fillRect(0,0,W,H);

  // Horizon
  const horizGrad = ctx.createLinearGradient(0,H*0.72,0,H);
  horizGrad.addColorStop(0,  'rgba(200,230,255,0)');
  horizGrad.addColorStop(0.5,'rgba(220,242,255,0.14)');
  horizGrad.addColorStop(1,  'rgba(255,252,245,0.28)');
  ctx.fillStyle = horizGrad; ctx.fillRect(0,H*0.72,W,H*0.28);

  // Layer labels
  ctx.save();
  labelDefs.forEach(({ yFrac, label, color:[r,g,b] }) => {
    const cy = yFrac*H;
    ctx.fillStyle = `rgba(${r},${g},${b},0.82)`;
    ctx.font = "bold 9.5px 'Courier New',monospace";
    ctx.fillText(label, 14, cy-7);
    ctx.setLineDash([3,7]);
    ctx.strokeStyle = `rgba(${r},${g},${b},0.22)`;
    ctx.lineWidth = 0.6;
    ctx.beginPath(); ctx.moveTo(0,cy); ctx.lineTo(W,cy); ctx.stroke();
    ctx.setLineDash([]);
  });
  ctx.restore();

  requestAnimationFrame(drawSky);
}
drawSky();
</script>
</body>
</html>
